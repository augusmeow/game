import{d as u,p as m}from"./utils-9fd45833.js";import{W as h}from"./wish-39e7899b.js";import"./zh-50a96649.js";u.locale("zh");const l=10;let c=u().year(2e3),i=u();const p=(s,n,f)=>{let e,o;s.start=s.start.replace(/-/g,"/"),s.end=s.end.replace(/-/g,"/"),e=m(s.start).subtract(0,"minute"),o=m(s.end).subtract(0,"minute");const d=o.diff(e,"day",!0);return c<o&&(c=o),{...s,index:n,index2:f,start:e,end:o,duration:d}},D=()=>{let s=[],n=[],f=[],e=[],o=[];o[0]=h.characters,o[1]=h.weapons;let d=o.map((t,r)=>Array.isArray(t)?t.map((a,y)=>p(a,r,y)):p(t,r,r));d.slice().sort((t,r)=>Array.isArray(t)&&Array.isArray(r)?t[0].start-r[0].start:!Array.isArray(t)&&Array.isArray(r)?t.start-r[0].start:Array.isArray(t)&&!Array.isArray(r)?t[0].start-r.start:t.start-r.start).forEach((t,r)=>{if(r===0&&(Array.isArray(t)?i=t[0].start.set("hour",0).set("minute",0).set("second",0).subtract(l,"day"):i=t.start.set("hour",0).set("minute",0).set("second",0).subtract(l,"day")),Array.isArray(t))for(let a=0;a<t.length;a++){const y=t[a];d[y.index][a].offset=Math.abs(i.diff(d[y.index][a].start,"day",!0))}else d[t.index].offset=Math.abs(i.diff(t.start,"day",!0))});const A=Math.abs(Math.ceil(i.diff(c,"day",!0)))+2*l;for(let t=0;t<A;t++){const r=i.add(t,"day").format("YYYY"),a=i.add(t,"day").format("MMMM");n[r]===void 0&&(n[r]=[]),n[r][a]===void 0&&(n[r][a]={total:0,offset:0}),n[r][a].total++}f=Object.entries(n);for(let t=0;t<f.length;t++){let r=Object.entries(f[t][1]);e=e.concat(r)}for(let t=0;t<e.length;t++)e[t][1].offset=t-1>=0?e[t-1][1].total+e[t-1][1].offset:0;return s=[...new Array(A)].map((t,r)=>{const a=i.add(r,"day");return[a.date(),a.format("dd")]}),{dates:s,years:n,yearList:f,monthList:e,events:d,firstDay:i}};export{D as p};
