import{f as v,G as A,r as E,h as R,i as b,j,k as H,l as y,m as N,n as _,g as L}from"./utils.Bdcn_rXA.js";import"./zh.jIn_hOuu.js";import{_ as k,o as c,c as h,j as r,a as T,a5 as I,a6 as D,F as p,C as g,t as m,e as O}from"./framework.isaGUk0Y.js";v.locale("zh");const S={name:"Fork",data(){return{sliceCharZH:[],displayRes:[],selectedLastChar:"",selectedFork:""}},props:{WISH:{type:Object,required:!0},CHARACTER:{type:Object,required:!0},GAME_NAME:{type:Number,required:!0,default:A.Genshin}},methods:{sortLast(){this.displayRes=this.displayRes.sort((o,s)=>o.tag-s.tag)},sortEarly(){this.displayRes=this.displayRes.sort((o,s)=>s.tag-o.tag)},getSelectDuration(o){let s=this.displayRes.find(l=>l.nameZH===o);return s?s.duration:"未找到"},replaceImg(o){o.target.src="/image/genshin/characters/paimon_faq.png"}},async mounted(){const o=Object.values(this.CHARACTER).filter(e=>e.star===5).map(e=>e.id);Object.values(this.CHARACTER).filter(e=>e.star===4).map(e=>e.id);const s=o.map(e=>this.CHARACTER[E(e)].name);this.sliceCharZH=s;let l={};(e=>{for(let t of e){l[t]=[];for(let d of this.WISH.characters){let f=d.wish5star.indexOf(t);if(f!==-1){let u={};u.name=d.name[f],u.image=d.image[f],u.shortName=d.wish5star[f],u.start=d.start,u.end=d.end,u.version=d.version,l[t].push(u)}}}})(o),l=R(l,e=>e.length),Object.values(l).forEach(function(e){Array.isArray(e)&&e.sort((t,d)=>d.image-t.image)});let i=[];Object.values(l).forEach(e=>{i.push(e[0])}),i=i.sort((e,t)=>b(e.end,t.end));for(let e of i)j(e.start,e.end)?e.duration=0:H(e.end)?e.duration=y(e.end):N(e.start)&&(e.duration=y(e.start));const n=e=>{let t="";return e>0?t=` ${parseInt(e)}天后登场`:e<0?t=` 距今${-parseInt(e)}天`:t=` 当前${L(this.GAME_NAME)}进行时`,t};let a=[];for(let e of i){let t={};t.shortName=e.shortName,t.nameZH=this.CHARACTER[e.shortName].name,t.src=_(this.GAME_NAME,e.shortName),t.version=e.version,t.duration=n(e.duration),t.tag=e.duration,a.push(t)}this.displayRes=a,this.selectedFork="",this.selectedLastChar="",this.sortEarly()}},F={key:0,class:"choose"},M={class:"underline"},W={class:"char-container"},Z={class:"char-avatar"},x=["src"],G={class:"char-info"},w={class:"char-name"},q={class:"char-version"},V={class:"char-duration"};function B(o,s,l,C,i,n){return c(),h(p,null,[r("a",{onClick:s[0]||(s[0]=(...a)=>n.sortLast&&n.sortLast(...a))},"最近排序"),s[6]||(s[6]=T(" | ")),r("a",{onClick:s[1]||(s[1]=(...a)=>n.sortEarly&&n.sortEarly(...a))},"最远排序"),s[7]||(s[7]=r("br",null,null,-1)),s[8]||(s[8]=r("br",null,null,-1)),I(r("select",{"onUpdate:modelValue":s[2]||(s[2]=a=>i.selectedLastChar=a)},[s[4]||(s[4]=r("option",{disabled:"",value:""},"选择角色",-1)),(c(!0),h(p,null,g(i.sliceCharZH,(a,e)=>(c(),h("option",null,m(a),1))),256))],512),[[D,i.selectedLastChar]]),i.selectedLastChar?(c(),h("p",F,[r("strong",null,m(i.selectedLastChar+" "),1),r("span",M,[r("span",null,m(n.getSelectDuration(i.selectedLastChar)),1)]),s[5]||(s[5]=r("br",null,null,-1))])):O("",!0),s[9]||(s[9]=r("hr",null,null,-1)),r("div",null,[(c(!0),h(p,null,g(i.displayRes,(a,e)=>(c(),h("div",{key:e},[r("div",W,[r("div",Z,[r("img",{src:a.src,onError:s[3]||(s[3]=(...t)=>n.replaceImg&&n.replaceImg(...t))},null,40,x)]),r("div",G,[r("div",w,m(a.nameZH),1),r("div",q,m("ver"+a.version),1),r("div",V,m(a.duration),1)])])]))),128))])],64)}const K=k(S,[["render",B],["__scopeId","data-v-79fd7f8a"]]);export{K as F};
